#!/usr/bin/env sh
set -e
cd "$(dirname "$0")/.."

if [ "$1" = "--fix" ]; then
    echo "Applying formatting..."
    cargo fmt
    echo "Applying clippy fixes..."
    # --allow-dirty/staged allows fixing even if git has changes
    cargo clippy --fix --allow-dirty --allow-staged
else
    echo "Checking formatting..."
    cargo fmt -- --check
    echo "Running clippy..."
    cargo clippy -- -D warnings
fi
