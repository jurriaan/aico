#!/bin/bash
set -e

cd "$(dirname "$0")/.."

export LITELLM_LOCAL_MODEL_COST_MAP=True

if [[ "$1" == co* ]]; then
    echo "Running tests for coverage (pytest --cov=app)..."
    uv run pytest --cov=app
else
    echo "Running tests (pytest)..."
    uv run pytest "$@" -vv
fi

echo ""
echo "Running functional tests (clitest)..."
if command -v clitest >/dev/null 2>&1; then
    tests/run_functional_tests.sh
else
    echo "Warning: clitest not found, skipping functional tests."
fi
